<link rel="import" href="bookmark.html">

<script>

    /**
     * 
     */
    class BookmarkImporter {

        constructor() {
            //
        }

        /**
         *
         */
        importBookmarks( files ) {
            if( !files ) {
                throw new Error( 'No file(s) provided' );
            }
            for( let file of files ) {
                console.log( 'File:', file.type, file.name );
                if( file.size < 2 ) {
                    throw new Error( `Invalid file size: ${file.size}` );
                }
                if( file.type === 'application/json' || file.name.endsWith( '.json' ) ) {
                    this._importBoommarksJSON( file );
                }
                if( file.type === 'application/x-sqlite3' || file.name.endsWith( '.db' ) ) {
                    this._importBookmarksFMD( file );
                }
            }
        }

        /**
         *
         */
        _importBoommarksJSON( file ) {
            console.log( '_importBoommarksJSON' );
            let fileReader = new FileReader();
            fileReader.onload = event => {
                console.log( 'File Loaded (JSON)', event.currentTarget.result );
            };
            fileReader.readAsText( file );
        }

        /**
         *
         */
        _importBookmarksFMD( file ) {
            console.log( '_importBookmarksFMD' );
            let fileReader = new FileReader();
            fileReader.onload = event => {
                console.log( 'File Loaded (SQLite3)', event.currentTarget.result );
                /*
                var arrayBuffer = e.target.result;
                var bytes = new Uint8Array(arrayBuffer);
                console.log(bytes);
                */
            };
            fileReader.readAsArrayBuffer( file );
        }
    }
    BookmarkImporter; // reference the class to prevent removal of the class through js-minify

</script>