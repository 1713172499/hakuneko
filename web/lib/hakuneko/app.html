<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="engine/loader.html">
<link rel="import" href="menu.html">
<link rel="import" href="mangas.html">
<link rel="import" href="chapters.html">
<link rel="import" href="pages.html">
<link rel="import" href="jobs.html">

<dom-module id="hakuneko-app">

    <template>
        <style include="theme"></style>
        <style>
            :host {
                display: flex;
                flex-direction: row;
                width: 100%;
                height: 100%;
            }
            .control {
                flex-direction: column;
                width: 100%;
                height: 100%;
                flex: 0;
                border-right: var(--app-control-border);
                -webkit-box-shadow: var(--app-control-shadow);
                   -moz-box-shadow: var(--app-control-shadow);
                        box-shadow: var(--app-control-shadow);
                z-index: 1;
            }
            .show {
                display: flex;
            }
            .hide {
                display: none;
            }
            .mangas {
                display: flex;
                flex-direction: row;
                /*width: 100%;*/
                /*height: 100%;*/
                flex: 1;
                border-top: var(--app-control-border);
                border-bottom: var(--app-control-border);
                min-height: 0; /* fix for firefox to limit flexbox height to fit in parent */
            }
            hakuneko-menu {
                flex: 0;
            }
            hakuneko-mangas {
                width: 20em;
            }
            hakuneko-chapters {
                width: 20em;
            }
            hakuneko-jobs {
                flex: 0;
            }
            hakuneko-pages {
                flex: 1;
                z-index: 0;
                overflow-x: hidden;
            }
        </style>
        <div class$="control [[ getControlClass(selectedPage) ]]">
            <hakuneko-menu ></hakuneko-menu>
            <div class="mangas">
                <hakuneko-mangas selected-connector="{{ connector }}" selected-manga="{{ manga }}"></hakuneko-mangas>
                <hakuneko-chapters selected-connector="[[ connector ]]" selected-manga="[[ manga ]]" selected-chapter="{{ chapter }}"></hakuneko-chapters>
            </div>
            <hakuneko-jobs></hakuneko-jobs>
        </div>
        <hakuneko-pages pages="[[ chapter.pages ]]" selected-page="{{ selectedPage }}"></hakuneko-pages>
    </template>

    <script>
        /** @polymerElement */
        class HakunekoApp extends Polymer.Element {
            /**
             *
             */
            static get is() {
                return 'hakuneko-app';
            }

            /**
             *
             */
            getControlClass( index ) {
                return ( index < 0 ? 'show' : 'hide' );
            }
        }
        window.customElements.define(HakunekoApp.is, HakunekoApp);
    </script>

</dom-module>