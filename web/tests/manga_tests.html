<link rel="import" href="./_testing.html">
<link rel="import" href="../lib/hakuneko/engine/loader.html">
<link rel="import" href="../lib/hakuneko/engine/base/manga.html">

<script>

    // wrap in scope to ensure declared variables/functions do not collide with other tests
    {
        let test = new TestCollection( 'Manga Tests' );
        test.register( 'formatChapterTitle' );

        test.run( 'formatChapterTitle', () => {
            // volume patterns
            let volumes = [
                {
                    data: '',
                    expected: '000'
                },
                {
                    data: '1',
                    expected: '001'
                },
                {
                    data: 'vol.1',
                    expected: '001'
                },
                {
                    data: 'vol. 1',
                    expected: '001'
                },
                {
                    data: ' VOL 00001 ',
                    expected: '00001'
                }
            ];
            // chapter patterns
            let chapters = [
                {
                    data: '',
                    expected: '0000'
                },
                {
                    data: '1',
                    expected: '0001'
                },
                {
                    data: 'ch.1',
                    expected: '0001'
                },
                {
                    data: 'ch. 1.2v3',
                    expected: '0001'
                },
                {
                    data: 'ch. 1-2',
                    expected: '0001'
                },
                {
                    data: ' CH 00001 : ',
                    expected: '00001'
                }
            ];
            // title patterns
            let titles = [
                'Title',
            ];
            //
            let formats = [
                {
                    original: '%VOL% %CH% %T%',
                    data: '%VOL%|%CH%|%T%',
                    expected: '%VOL%|%CH%|%T%'
                }
            ];
            let manga = new Manga();
            for(v of volumes) {
                for(c of chapters) {
                    for( t of titles ) {
                        for( f of formats ) {
                            // compose original
                            let original = f.original;
                            original = original.replace( '%VOL%', v.data );
                            original = original.replace( '%CH%', c.data );
                            original = original.replace( '%T%', t.data );
                            // compose expected
                            let expected = f.expected;
                            expected = expected.replace( '%VOL%', v.expected );
                            expected = expected.replace( '%CH%', c.expected );
                            expected = expected.replace( '%T%', t.expected );

                            Assert.equal( expected, manga.formatChapterTitle( original, f.data ) );
                        }
                    }
                }
            }
            /*
            // with volume and chapter and 'Read Online'
            test( 'Vol.1 Ch.2: Read Online', ['Vol.1', '2', ''] );
            // with volume and chapter
            test( 'Vol.1 Ch.2: Meow', ['Vol.1', '2', 'Meow'] );
            // with volume and without chapter
            test( 'Vol.1: Meow' , ['Vol.1', '', 'Meow']);
            // without volume and chapter
            test( 'Meow', ['', '', 'Meow'] );
            // starts with chapter number
            test( '1 Meow', ['', '1', '1 Meow'] );
            // ends with chapter number
            test( 'Meow 1', ['', '1', 'Meow 1'] );
            // chapter with dot
            test( 'Vol.1 Ch.2.3: Meow', ['Vol.1', '2.3', 'Meow'] );
            // chapter with v
            test( 'Vol.1 Ch.2v3: Meow', ['Vol.1', '2v3', 'Meow'] );
            // chapter with dot and v
            test( 'Vol.1 Ch.2.3v4: Meow', ['Vol.1', '2.3v4', 'Meow'] );
            // chapter range with dash
            test( 'Vol.1 Ch.2-3: Meow', ['Vol.1', '2-3', 'Meow'] );
            */
        });
    }

</script>